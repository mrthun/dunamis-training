<br /><%= link_to "Add New Timesheet", new_timesheets_path %><br /><br />
 <div id="details_content" style="OVERFLOW: auto; WIDTH: 500px; HEIGHT: 100px; margin-left: 4px;float:left; "> </div>
 <div id="edit" style="OVERFLOW: auto; WIDTH: 500px; HEIGHT: 400px; margin-left: 4px;float:left"> </div>
 <div id="images" style="OVERFLOW: auto; WIDTH: 500px; HEIGHT: 400px; margin-left: 4px;float:left"> </div>
 <div id="selectedimage" style="OVERFLOW: auto; WIDTH: 500px; HEIGHT: 400px; margin-left: 4px;float:left"> </div>
 
<h1>Timesheets</h1

<div id="list" style="OVERFLOW: auto; WIDTH: 300px; HEIGHT: 20px; margin-left: 4px;">
<% unless @timesheets.blank? %>
  <table>
    <tr>
      <th>Client</th>
      <th>Registrant</th>
      <th>Facility</th>
      <th>Status</th>
      <th>Date(end of week)</th>
      <th>Total Hours</th>
      <th>Actions</th>
    </tr>
    <% @timesheets.each do |sheet| %>
     
    <tr style="cursor: pointer;" onclick="details('<%=sheet.id%>');">
        <td><%= sheet.client.display_name %></td>
        <td><%= sheet.registrant.display_name %></td>
        <td><%= sheet.facility %></td>
        <td><%= sheet.status %></td>
        <td><%= sheet.end_of_week.strftime("%d/%m/%Y") %></td>
        <td><%= sheet.total_hours %></td>
        <td>
          
      


          <%= link_to 'View_Details', details_timesheets_path(:id => sheet.id ) %> |
          <% unless current_user.is_registrant? %>
            <%= link_to 'Edit', edit_timesheets_path(:id => sheet.id) %> |
            <%= link_to 'Delete', delete_timesheets_path(:id => sheet.id) %>
          <%else%>
            <%= link_to 'Edit', edit_timesheets_path(:id => sheet.id) if current_user.timesheets_of.include?(sheet)%>
          <%  end %>
        </td>
      </tr>
    <%end%>
  </table>
<%else%>
  Sorry! No TimeSheet listed yet.<br />
<%end%>
 </div>

 

<script type="text/javascript">
     function details(id) {
      var container = $("#details_content");

    $.ajax({
      url: '/timesheets/details?id='+id,
      type: 'get',
      dataType: 'html',
      processData: false,
      success: function(data) {
      container.html(data);
      }
    });
     myedit(id);
     load_images(id)
      return false;

   }
       function myedit(id) {


      var container = $("#edit");

    $.ajax({
      url: '/timesheets/myedit?id='+id,
      type: 'get',
      dataType: 'html',
      processData: false,
      success: function(data) {
      container.html(data);
      }
    });



   }
function load_images(id) {


      var container = $("#images");

    $.ajax({
      url: '/timesheets/load_timesheet_images?id='+id,
      type: 'get',
      dataType: 'html',
      processData: false,
      success: function(data) {
      container.html(data);
      }
    });



   }
function load_selected_image(id) {


      var container = $("#selectedimage");

    $.ajax({
      url: '/timesheets/load_selected_image?id='+id,
      type: 'get',
      dataType: 'html',
      processData: false,
      success: function(data) {
      container.html(data);
      }
    });



   }



</script>